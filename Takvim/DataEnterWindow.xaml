<UserControl
    x:Class="Takvim.DataEnterWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
    xmlns:TwainControl="clr-namespace:TwainControl;assembly=TwainControl"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Takvim"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    x:Name="UserControl"
    Width="640"
    Height="520"
    Margin="2"
    d:DataContext="{d:DesignInstance Type={x:Type local:Data}}"
    Loaded="UserControl_Loaded"
    Unloaded="UserControl_Unloaded"
    UseLayoutRounding="True"
    mc:Ignorable="d">
    <UserControl.Resources>
        <local:NullableToBooleanConverter x:Key="NullableToBooleanConverter" />
        <CollectionViewSource x:Key="FilteredCvs" Source="{StaticResource XmlData}" />
    </UserControl.Resources>
    <Microsoft_Windows_Themes:SystemDropShadowChrome>
        <GroupBox>
            <GroupBox.Header>
                <UniformGrid Columns="2">
                    <TextBlock><Run Text="VERİ GİR" /><Run Text=" " /><Run Language="tr-tr" Text="{Binding TamTarih, StringFormat=\{0:d\}}" /></TextBlock>
                    <TextBlock
                        HorizontalAlignment="Right"
                        FontFamily="Segoe UI Black"
                        FontSize="15"><Hyperlink Command="{Binding PencereKapat}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                            <Run Text="X" />
                        </Hyperlink></TextBlock>
                </UniformGrid>
            </GroupBox.Header>
            <GroupBox.Style>
                <Style BasedOn="{StaticResource {x:Type GroupBox}}" TargetType="{x:Type GroupBox}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding GünAdı}" Value="Cmt">
                            <Setter Property="Background" Value="{Binding Owner.DataContext.SeçiliRenkCmt, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding GünAdı}" Value="Paz">
                            <Setter Property="Background" Value="{Binding Owner.DataContext.SeçiliRenkPaz, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Converter={StaticResource GünTatilConverter}, Mode=OneWay}" Value="true">
                            <Setter Property="Background" Value="{Binding Owner.DataContext.ResmiTatilRenk, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Converter={StaticResource GünTatilConverter}, Mode=OneWay}" Value="{x:Null}">
                            <Setter Property="Background" Value="{Binding Owner.DataContext.ResmiTatilRenk, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding TamTarih, Converter={StaticResource DatePassedBooleanConverter}}" Value="true">
                            <Setter Property="Background" Value="Gray" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </GroupBox.Style>
            <TabControl>
                <TabItem Header="VERİ GİRİŞİ">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="1.5*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBox
                            Grid.RowSpan="2"
                            AcceptsReturn="True"
                            Text="{Binding GünNotAçıklama, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}"
                            TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Visible" />
                        <Grid Grid.Column="1">
                            <Image Source="{Binding ResimData, ConverterParameter=96, Converter={StaticResource WebpByteArrayToImageConverter}, Mode=OneWay}" />
                            <ContentControl
                                Width="16"
                                Height="16"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                IsEnabled="{Binding ResimData, Converter={StaticResource NullableToBooleanConverter}, Mode=OneWay}"
                                Template="{StaticResource Eye}">
                                <ContentControl.ToolTip>
                                    <ToolTip Template="{StaticResource GreenToolTipControlTemplate}">
                                        <Grid>
                                            <Image Source="{Binding ResimData, Converter={StaticResource WebpByteArrayToImageConverter}, Mode=OneWay}" />
                                            <Viewbox Width="200" Height="200">
                                                <TextBlock Foreground="Red" Text="{Binding Boyut, StringFormat=\{0\} KB}" />
                                            </Viewbox>
                                        </Grid>
                                    </ToolTip>
                                </ContentControl.ToolTip>
                            </ContentControl>
                        </Grid>
                        <Slider
                            Grid.Row="1"
                            Grid.Column="1"
                            AutoToolTipPlacement="TopLeft"
                            IsSnapToTickEnabled="True"
                            IsTabStop="False"
                            LargeChange="1"
                            Maximum="100"
                            Minimum="1"
                            SmallChange="1"
                            TickFrequency="1"
                            ToolTip="WEBP RESİM YÜKLEME KALİTESİ 1 EN DÜŞÜK BOYUTTUR. DEĞERİ DEĞİŞTİRİP DOSYAYI TEKRAR YÜKLEYİP ÖNİZLEME GÖZÜNDEN BAKIN"
                            Value="{Binding WebpQuality, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <UniformGrid
                            Grid.Row="2"
                            Grid.ColumnSpan="2"
                            Columns="3">
                            <CheckBox
                                VerticalAlignment="Center"
                                Content="ÖNEMLİ Mİ"
                                Foreground="Red"
                                IsChecked="{Binding ÖnemliMi, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}" />
                            <CheckBox
                                VerticalAlignment="Center"
                                Content="AY TEKRAR"
                                IsChecked="{Binding AyTekrar, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}"
                                ToolTip="BU İŞARETLENİRSE HER AYIN AYNI GÜNÜNE İŞARET VERİLİR" />
                            <ComboBox
                                ItemContainerStyle="{StaticResource ComboBoxItemContainerStyle}"
                                ItemTemplate="{StaticResource ComboBoxRectItemTemplate}"
                                ItemsPanel="{StaticResource CbItemsPanelTemplate}"
                                ItemsSource="{Binding Source={StaticResource Renkler}}"
                                ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                SelectedValue="{Binding VeriRenk, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}"
                                SelectedValuePath="Name"
                                ToolTip="Veri Renk" />
                        </UniformGrid>
                        <Slider
                            Grid.Row="3"
                            Grid.ColumnSpan="2"
                            AutoToolTipPlacement="TopLeft"
                            AutoToolTipPrecision="1"
                            IsSnapToTickEnabled="True"
                            LargeChange="0.5"
                            Maximum="99"
                            Minimum="0"
                            SmallChange="0.5"
                            TickFrequency="0.5"
                            ToolTip="ETKİNLİK SÜRESİ SAAT"
                            Value="{Binding EtkinlikSüresi, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}" />
                        <local:MaskedTextBox
                            x:Name="TbBaslangiç"
                            Grid.Row="4"
                            Grid.ColumnSpan="2"
                            ClearButtonVisibility="Visible"
                            IncludePrompt="False"
                            Mask="00:00"
                            PromptChar="_"
                            Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}"
                            Value="{Binding SaatBaşlangıç, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}" />
                        <Button
                            Grid.Row="5"
                            Grid.ColumnSpan="2"
                            Command="{Binding ResimYükle, Mode=OneWay}"
                            Content="RESİM YÜKLE">
                            <Button.ContextMenu>
                                <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Mode=Self}}">
                                    <MenuItem Command="{Binding Resimİptal}" Header="RESİM İPTAL" />
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                        <Button
                            Grid.Row="6"
                            Grid.ColumnSpan="2"
                            Command="{Binding DosyalarYükle, Mode=OneWay}">
                            <Button.ContextMenu>
                                <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Mode=Self}}">
                                    <MenuItem Command="{Binding Dosyalarİptal}" Header="DOSYALAR İPTAL" />
                                </ContextMenu>
                            </Button.ContextMenu>
                            <TextBlock><Run Text="DOSYALAR YÜKLE" /><Run Text=" " /><Run Foreground="Red" Text="(LINK OLARAK)" /><Run Text=" " /><Run Foreground="Red" Text="{Binding Dosyalar.Count, Mode=OneWay, StringFormat=\{0\} DOSYA}" /></TextBlock>
                        </Button>
                        <Button
                            Grid.Row="7"
                            Grid.ColumnSpan="2"
                            Command="{Binding XmlVeriEkle, Mode=OneWay}"
                            Content="VERİYİ EKLE" />
                        <ListBox
                            Grid.RowSpan="8"
                            Grid.Column="2"
                            ItemContainerStyle="{StaticResource ListBoxToolTipItemContainerStyle}"
                            ItemsSource="{Binding Mode=OneWay, Source={StaticResource FilteredCvs}}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock FontFamily="Segoe UI Black" FontSize="12"><Hyperlink
                                                    x:Name="Hyp"
                                                    Command="{Binding DataContext.XmlVeriSil, ElementName=UserControl}"
                                                    CommandParameter="{Binding XPath=@Id}">
                                                    <Run Text="X" />
                                                </Hyperlink></TextBlock>
                                            <TextBlock><Run Text="{Binding XPath=@SaatBaslangic}" /><Run Text=" " /><Run Text="{Binding XPath=Aciklama}" /></TextBlock>
                                            <ContentControl IsTabStop="False" Template="{Binding Mode=OneWay, Source={StaticResource TimePanel}}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel.DataContext>
                                                <local:Data />
                                            </StackPanel.DataContext>
                                            <local:MaskedTextBox
                                                Width="45"
                                                IncludePrompt="False"
                                                Mask="00:00"
                                                PromptChar="_"
                                                Value="{Binding SaatBaşlangıç, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <local:MaskedTextBox
                                                Width="35"
                                                IncludePrompt="False"
                                                Mask="00"
                                                PromptChar="_"
                                                ValueType="{x:Type system:Double}"
                                                Value="{Binding EtkinlikSüresi, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                            <CheckBox
                                                VerticalAlignment="Center"
                                                Content="AY TEKRAR"
                                                IsChecked="{Binding AyTekrar}" />
                                            <Button
                                                Command="{Binding XmlVeriGüncelle, Mode=OneWay}"
                                                CommandParameter="{Binding CommandParameter, ElementName=Hyp}"
                                                Content="P"
                                                FontFamily="Wingdings 3"
                                                ToolTip="GÜNCELLE" />
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                            <ListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel />
                                </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                        </ListBox>
                    </Grid>
                </TabItem>
                <TabItem Header="TARAYICI">
                    <TwainControl:TwainCtrl />
                </TabItem>
            </TabControl>
        </GroupBox>
    </Microsoft_Windows_Themes:SystemDropShadowChrome>
</UserControl>